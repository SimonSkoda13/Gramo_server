"use strict";
/*
 * Copyright (c) 2021.
 * Author Peter Placzek (tada5hi)
 * For the full copyright and license information,
 * view the LICENSE file that was distributed with this source code.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.buildQueryFilters = void 0;
const utils_1 = require("../../utils");
const type_1 = require("./type");
function buildQueryFilters(data) {
    return (0, utils_1.flattenNestedProperties)(transformOperatorConfigToValue(data));
}
exports.buildQueryFilters = buildQueryFilters;
const OperatorWeight = {
    [type_1.FilterOperator.NEGATION]: 0,
    [type_1.FilterOperator.LIKE]: 50,
    [type_1.FilterOperator.IN]: 150
};
function transformOperatorConfigToValue(data) {
    if (Object.prototype.toString.call(data) !== '[object Object]') {
        return data;
    }
    for (let key in data) {
        if (data.hasOwnProperty('operator') &&
            data.hasOwnProperty('value')) {
            const config = data;
            if (Array.isArray(config.operator)) {
                data.operator = config.operator
                    .sort((a, b) => {
                    return OperatorWeight[a] <= OperatorWeight[b] ? -1 : 1;
                })
                    .join('');
            }
        }
        else {
            data[key] = transformOperatorConfigToValue(data[key]);
        }
    }
    return data;
}
//# sourceMappingURL=build.js.map